{% extends "base.html" %}

{% block title %}–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç–æ–≤{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="row mb-4">
        <div class="col-12">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li class="breadcrumb-item active">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç–æ–≤</li>
                </ol>
            </nav>
            
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="display-5 text-primary mb-2">
                        <i class="fas fa-gavel me-3"></i>
                        –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç–æ–≤ –†–ö
                    </h1>
                    <p class="lead text-muted">–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç–∞ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω</p>
                </div>
                
                <div class="text-end">
                    <div class="card border-0 bg-light">
                        <div class="card-body p-3">
                            <h6 class="card-title mb-1">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h6>
                            <small class="text-muted">
                                –í—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–æ–≤: <span class="fw-bold">{{ law_stats.total_projects }}</span><br>
                                –ó–∞ –º–µ—Å—è—Ü: <span class="fw-bold">{{ law_stats.recent_projects }}</span>
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å - –ü—Ä–æ–≥—Ä–µ—Å—Å –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
        <div class="col-lg-3">
            <div class="card border-0 shadow-sm sticky-top" style="top: 20px;">
                <div class="card-header bg-primary text-white">
                    <h6 class="mb-0">
                        <i class="fas fa-list-check me-2"></i>
                        –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
                    </h6>
                </div>
                <div class="card-body p-0">
                    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
                    <div class="p-3 border-bottom">
                        <div class="d-flex justify-content-between mb-2">
                            <small class="text-muted">–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å</small>
                            <small class="text-muted"><span id="progress-percentage">0</span>%</small>
                        </div>
                        <div class="progress" style="height: 8px;">
                            <div id="progress-bar" class="progress-bar bg-success" role="progressbar" style="width: 0%;"></div>
                        </div>
                    </div>
                    
                    <!-- –°–ø–∏—Å–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ -->
                    <div class="list-group list-group-flush" id="sections-nav">
                        {% for section in questions %}
                        <div class="list-group-item list-group-item-action section-nav-item" 
                             data-section="{{ section.id }}" 
                             data-index="{{ loop.index0 }}">
                            <div class="d-flex align-items-center">
                                <div class="me-3">
                                    <i class="fas fa-circle text-muted section-status-icon" style="font-size: 0.7rem;"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-1 fw-normal">{{ section.title }}</h6>
                                    <small class="text-muted">{{ section.questions|length }} –ø–æ–ª–µ–π</small>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ -->
                <div class="card-footer bg-light">
                    <!-- –í—ã–±–æ—Ä —è–∑—ã–∫–∞ -->
                    <div class="mb-3">
                        <label for="generation-language" class="form-label small text-muted">–Ø–∑—ã–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞:</label>
                        <select id="generation-language" class="form-select form-select-sm">
                            <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π (–æ—Å–Ω–æ–≤–Ω–æ–π)</option>
                            <option value="kz">üá∞üáø “ö–∞–∑–∞“õ—à–∞ (–Ω–µ–≥—ñ–∑–≥—ñ)</option>
                            <option value="bilingual">üåç –î–≤—É—è–∑—ã—á–Ω—ã–π (–µ—Ä—ñ–∫—Ç—ñ)</option>
                        </select>
                    </div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
                    <div class="d-grid gap-2">
                        <button id="fill-test-data-btn" class="btn btn-outline-info btn-sm">
                            <i class="fas fa-flask me-2"></i>–ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                        </button>
                        <button id="validate-btn" class="btn btn-outline-primary btn-sm" disabled>
                            <i class="fas fa-check-circle me-2"></i>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
                        </button>
                        <button id="generate-btn" class="btn btn-success btn-sm" disabled>
                            <i class="fas fa-magic me-2"></i>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç
                        </button>
                        <hr class="my-2">
                        <button id="history-btn" class="btn btn-outline-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#historyModal">
                            <i class="fas fa-history me-2"></i>–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å - –§–æ—Ä–º–∞ -->
        <div class="col-lg-9">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-bottom">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-1" id="current-section-title">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h5>
                            <small class="text-muted" id="current-section-description">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –±–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç–µ</small>
                        </div>
                        <div class="btn-group" role="group">
                            <button id="prev-section" class="btn btn-outline-secondary btn-sm" disabled>
                                <i class="fas fa-chevron-left"></i> –ù–∞–∑–∞–¥
                            </button>
                            <button id="next-section" class="btn btn-outline-primary btn-sm">
                                –î–∞–ª–µ–µ <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card-body">
                    <!-- –§–æ—Ä–º–∞ -->
                    <form id="law-generator-form">
                        {% for section in questions %}
                        <div class="form-section{% if not loop.first %} d-none{% endif %}" 
                             id="section-{{ section.id }}" 
                             data-section="{{ section.id }}">
                            
                            <div class="row">
                                {% for question in section.questions %}
                                <div class="col-md-{% if question.type == 'textarea' %}12{% else %}6{% endif %} mb-4">
                                    <label for="{{ question.field }}" class="form-label">
                                        {{ question.question }}
                                        {% if question.required %}
                                        <span class="text-danger">*</span>
                                        {% endif %}
                                        <i class="fas fa-question-circle text-muted ms-1" 
                                           data-bs-toggle="tooltip" 
                                           data-field="{{ question.field }}"
                                           title="–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø—Ä–∞–≤–∫–∏"></i>
                                    </label>
                                    
                                    {% if question.type == 'text' %}
                                    <input type="text" 
                                           class="form-control" 
                                           id="{{ question.field }}" 
                                           name="{{ question.field }}"
                                           data-required="{{ question.required|lower }}"
                                           placeholder="–í–≤–µ–¥–∏—Ç–µ {{ question.question.lower() }}">
                                    
                                    {% elif question.type == 'textarea' %}
                                    <textarea class="form-control" 
                                              id="{{ question.field }}" 
                                              name="{{ question.field }}"
                                              data-required="{{ question.required|lower }}"
                                              rows="4"
                                              placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—à–∏—Ç–µ {{ question.question.lower() }}"></textarea>
                                    
                                    {% elif question.type == 'select' %}
                                    <select class="form-select" 
                                            id="{{ question.field }}" 
                                            name="{{ question.field }}"
                                            data-required="{{ question.required|lower }}">
                                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ...</option>
                                        {% for option in question.options %}
                                        <option value="{{ option }}">{{ option }}</option>
                                        {% endfor %}
                                    </select>
                                    {% endif %}
                                    
                                    <div class="form-text text-muted" id="{{ question.field }}-help"></div>
                                    <div class="invalid-feedback" id="{{ question.field }}-error"></div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endfor %}
                    </form>
                </div>
            </div>
            
            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ -->
            <div id="validation-results" class="mt-4 d-none">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-info text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-clipboard-check me-2"></i>
                            –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏
                        </h6>
                    </div>
                    <div class="card-body">
                        <div id="validation-content">
                            <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ -->
            <div id="generation-results" class="mt-4 d-none">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-success text-white">
                        <h6 class="mb-0">
                            <i class="fas fa-file-text me-2"></i>
                            –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
                        </h6>
                    </div>
                    <div class="card-body">
                        <div id="generation-content">
                            <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–ø—Ä–∞–≤–∫–∏ -->
<div class="modal fade" id="helpModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–°–ø—Ä–∞–≤–∫–∞ –ø–æ –ø–æ–ª—é</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="help-content">
                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–ø—Ä–∞–≤–∫–∏ -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≥—Ä—É–∑–∫–∏ -->
<div class="modal fade" id="loadingModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body text-center py-4">
                <div class="spinner-border text-primary mb-3" role="status">
                    <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <h6 id="loading-message">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞...</h6>
                <p class="text-muted mb-0" id="loading-description">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ. –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç.</p>
            </div>
        </div>
    </div>
</div>

<!-- –î–∞–Ω–Ω—ã–µ –¥–ª—è JavaScript -->
<script type="application/json" id="sections-data">{{ questions | tojson | safe }}</script>

<script>
// JavaScript –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–æ—Ä–º–æ–π
document.addEventListener('DOMContentLoaded', function() {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–æ–≤
    window.sectionsData = JSON.parse(document.getElementById('sections-data').textContent);
    const form = document.getElementById('law-generator-form');
    const sections = document.querySelectorAll('.form-section');
    const navItems = document.querySelectorAll('.section-nav-item');
    const prevBtn = document.getElementById('prev-section');
    const nextBtn = document.getElementById('next-section');
    const validateBtn = document.getElementById('validate-btn');
    const generateBtn = document.getElementById('generate-btn');
    const progressBar = document.getElementById('progress-bar');
    const progressPercentage = document.getElementById('progress-percentage');
    
    let currentSection = 0;
    let formData = {};
    let validationResults = {};
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    updateNavigation();
    updateProgress();
    
    // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
    function showSection(index) {
        sections.forEach((section, i) => {
            if (i === index) {
                section.classList.remove('d-none');
                section.classList.add('d-block');
            } else {
                section.classList.remove('d-block');
                section.classList.add('d-none');
            }
        });
        
        navItems.forEach((item, i) => {
            item.classList.toggle('active', i === index);
        });
        
        currentSection = index;
        updateNavigation();
        updateCurrentSectionInfo();
    }
    
    function updateNavigation() {
        prevBtn.disabled = currentSection === 0;
        nextBtn.disabled = currentSection === sections.length - 1;
    }
    
    function updateCurrentSectionInfo() {
        const sectionData = window.sectionsData;
        const current = sectionData[currentSection];
        document.getElementById('current-section-title').textContent = current.title;
        document.getElementById('current-section-description').textContent = 
            `–†–∞–∑–¥–µ–ª ${currentSection + 1} –∏–∑ ${sections.length}`;
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    prevBtn.addEventListener('click', () => {
        if (currentSection > 0) {
            showSection(currentSection - 1);
        }
    });
    
    nextBtn.addEventListener('click', () => {
        if (currentSection < sections.length - 1) {
            collectCurrentSectionData();
            showSection(currentSection + 1);
        }
    });
    
    // –ù–∞–≤–∏–≥–∞—Ü–∏—è —á–µ—Ä–µ–∑ –±–æ–∫–æ–≤—É—é –ø–∞–Ω–µ–ª—å
    navItems.forEach((item, index) => {
        item.addEventListener('click', () => {
            collectCurrentSectionData();
            showSection(index);
        });
    });
    
    // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞–∑–¥–µ–ª–∞
    function collectCurrentSectionData() {
        const currentFormSection = sections[currentSection];
        const inputs = currentFormSection.querySelectorAll('input, textarea, select');
        
        inputs.forEach(input => {
            if (input.value.trim()) {
                formData[input.name] = input.value.trim();
            }
        });
        
        updateProgress();
        validateRequiredFields();
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    function updateProgress() {
        const totalFields = form.querySelectorAll('input, textarea, select').length;
        const filledFields = Object.keys(formData).length;
        const percentage = Math.round((filledFields / totalFields) * 100);
        
        progressBar.style.width = percentage + '%';
        progressPercentage.textContent = percentage;
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ä–∞–∑–¥–µ–ª–æ–≤
        const sectionData = window.sectionsData;
        sectionData.forEach((section, index) => {
            const sectionFields = section.questions.map(q => q.field);
            const sectionFilledFields = sectionFields.filter(field => formData[field]);
            const sectionProgress = sectionFilledFields.length / sectionFields.length;
            
            const navItem = navItems[index];
            const statusIcon = navItem.querySelector('.section-status-icon');
            
            if (sectionProgress === 1) {
                statusIcon.className = 'fas fa-check-circle text-success section-status-icon';
            } else if (sectionProgress > 0) {
                statusIcon.className = 'fas fa-clock text-warning section-status-icon';
            } else {
                statusIcon.className = 'fas fa-circle text-muted section-status-icon';
            }
        });
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
    function validateRequiredFields() {
        const requiredFields = form.querySelectorAll('[data-required="true"]');
        const allRequiredFilled = Array.from(requiredFields).every(field => {
            const fieldName = field.getAttribute('name');
            return formData[fieldName] && formData[fieldName].toString().trim().length > 0;
        });
        
        // –ú–∏–Ω–∏–º—É–º 5 –ø–æ–ª–µ–π –∑–∞–ø–æ–ª–Ω–µ–Ω–æ
        const minFieldsFilled = Object.keys(formData).length >= 5;
        
        validateBtn.disabled = !(allRequiredFilled && minFieldsFilled);
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–µ–π
    form.addEventListener('input', function(e) {
        collectCurrentSectionData();
    });
    
    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    const fillTestDataBtn = document.getElementById('fill-test-data-btn');
    fillTestDataBtn.addEventListener('click', function() {
        if (confirm('–ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏? –≠—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç –≤—Å–µ —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ.')) {
            fillTestData();
        }
    });
    
    function fillTestData() {
        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç–∞ –æ–± —ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç–∞—Ö
        const testData = {
            // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (basic_info)
            'title_ru': '–û –≤–Ω–µ—Å–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å–Ω—ã–µ –∞–∫—Ç—ã –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç–æ–≤',
            'title_kz': '–≠–ª–µ–∫—Ç—Ä —Å–∞–º–æ–∫–∞—Ç—Ç–∞—Ä—ã–Ω –ø–∞–π–¥–∞–ª–∞–Ω—É–¥—ã —Ä–µ—Ç—Ç–µ—É –º”ô—Å–µ–ª–µ–ª–µ—Ä—ñ –±–æ–π—ã–Ω—à–∞ “ö–∞–∑–∞“õ—Å—Ç–∞–Ω –†–µ—Å–ø—É–±–ª–∏–∫–∞—Å—ã–Ω—ã“£ –∫–µ–π–±—ñ—Ä –∑–∞“£–Ω–∞–º–∞–ª—ã“õ –∞–∫—Ç—ñ–ª–µ—Ä—ñ–Ω–µ ”©–∑–≥–µ—Ä—ñ—Å—Ç–µ—Ä –µ–Ω–≥—ñ–∑—É —Ç—É—Ä–∞–ª—ã',
            'initiator': '–ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –¥–µ–ª –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω',
            'initiator_type': '–º–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ',
            
            // –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã (problem_analysis)
            'problem_description': '–†–µ–∑–∫–∏–π —Ä–æ—Å—Ç –î–¢–ü –∏ —Ç—Ä–∞–≤–º —Å —É—á–∞—Å—Ç–∏–µ–º —ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç–æ–≤ –≤ –≥–æ—Ä–æ–¥–∞—Ö –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –Ω–æ—Ä–º—ã –ü–î–î —Ä–µ–≥—É–ª–∏—Ä—É—é—Ç —Ç–æ–ª—å–∫–æ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞, —á—Ç–æ —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–∞–≤–æ–≤–æ–π –≤–∞–∫—É—É–º. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ú–í–î –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 1482 –î–¢–ü —Å —É—á–∞—Å—Ç–∏–µ–º –ª–µ–≥–∫–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ —ç–ª–µ–∫—Ç—Ä–æ—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –≤ 2024 –≥–æ–¥—É.',
            'current_legislation_gaps': '–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç–æ–≤ –≤ –ü–î–î –†–ö. –ù–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å –ø—Ä–∞–≤–æ–≤–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –≤–æ–¥–∏—Ç–µ–ª–µ–π —ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç–æ–≤. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –ü—Ä–æ–±–µ–ª—ã –≤ —Å—Ç—Ä–∞—Ö–æ–≤–æ–º –ø–æ–∫—Ä—ã—Ç–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –∫–∏–∫-—à–µ—Ä–∏–Ω–≥–∞.',
            'target_audience': '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç–æ–≤, —Å–µ—Ä–≤–∏—Å—ã –∫–∏–∫-—à–µ—Ä–∏–Ω–≥–∞, –ø–µ—à–µ—Ö–æ–¥—ã, –≤–æ–¥–∏—Ç–µ–ª–∏ –∞–≤—Ç–æ—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞, –æ—Ä–≥–∞–Ω—ã –¥–æ—Ä–æ–∂–Ω–æ–π –ø–æ–ª–∏—Ü–∏–∏',
            
            // –¶–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏ (goals_objectives)
            'goals': '–°–Ω–∏–∑–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –î–¢–ü —Å —ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç–∞–º–∏ –Ω–∞ 30% –∫ 2027 –≥., –û–±–µ—Å–ø–µ—á–∏—Ç—å 100% —Å—Ç—Ä–∞—Ö–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤ –∫–∏–∫-—à–µ—Ä–∏–Ω–≥–∞, –í–≤–µ—Å—Ç–∏ —á—ë—Ç–∫—É—é –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é –ª—ë–≥–∫–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ —ç–ª–µ–∫—Ç—Ä–æ—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ (–õ–ü–≠–¢), –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç–æ–≤',
            'international_experience': '–†–µ–≥–ª–∞–º–µ–Ω—Ç –ï–° 2021/241 –ø–æ –º–∏–∫—Ä–æ–º–æ–±–∏–ª—å–Ω–æ—Å—Ç–∏. –ú–æ–¥–µ–ª—å–Ω—ã–π –∑–∞–∫–æ–Ω –ú–ü–ê –°–ù–ì ¬´–û –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –õ–ü–≠–¢¬ª. –û–ø—ã—Ç –ì–µ—Ä–º–∞–Ω–∏–∏ –ø–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—é —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–æ 20 –∫–º/—á. –ü—Ä–∞–∫—Ç–∏–∫–∞ –§—Ä–∞–Ω—Ü–∏–∏ –ø–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–º—É —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—é –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤.',
            
            // –ü—Ä–∞–≤–æ–≤–∞—è –æ—Å–Ω–æ–≤–∞ (legal_basis)
            'constitutional_basis': '–°—Ç–∞—Ç—å—è 6 –ö–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏ –†–ö - –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –°—Ç–∞—Ç—å—è 31 - –ø—Ä–∞–≤–æ –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—É—é –æ–∫—Ä—É–∂–∞—é—â—É—é —Å—Ä–µ–¥—É. –°—Ç–∞—Ç—å—è 77 - —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.',
            'hierarchy_compliance': '–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–æ—Å—è—Ç—Å—è –≤ –ö–æ–ê–ü –†–ö –∏ –ó–∞–∫–æ–Ω "–û –¥–æ—Ä–æ–∂–Ω–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏" –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π –ù–ü–ê. –ù–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç –ö–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏ –†–ö –∏ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–º –¥–æ–≥–æ–≤–æ—Ä–∞–º.',
            
            // –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ (economic_impact)
            'budget_impact': '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤ –æ—Ç —à—Ç—Ä–∞—Ñ–æ–≤ –Ω–∞ 50-100 –º–ª–Ω —Ç–µ–Ω–≥–µ –≤ –≥–æ–¥. –≠–∫–æ–Ω–æ–º–∏—è –Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —Ä–∞—Å—Ö–æ–¥–∞—Ö –∑–∞ —Å—á–µ—Ç —Å–Ω–∏–∂–µ–Ω–∏—è —Ç—Ä–∞–≤–º–∞—Ç–∏–∑–º–∞ –Ω–∞ 200-300 –º–ª–Ω —Ç–µ–Ω–≥–µ. –†–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ–ª–∏—Ü–∏–∏ 15 –º–ª–Ω —Ç–µ–Ω–≥–µ.',
            'economic_benefits': '–°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏—Ö –≤ –î–¢–ü. –†–∞–∑–≤–∏—Ç–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –≥–æ—Ä–æ–¥—Å–∫–æ–π –º–æ–±–∏–ª—å–Ω–æ—Å—Ç–∏. –°—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞ –≤ —Å—Ñ–µ—Ä–µ –∫–∏–∫-—à–µ—Ä–∏–Ω–≥–∞. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç –≤ —Å—Ñ–µ—Ä–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è.',
            'funding_sources': '–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –±—é–¥–∂–µ—Ç, —à—Ç—Ä–∞—Ñ–Ω—ã–µ —Å–∞–Ω–∫—Ü–∏–∏, —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ –≤–∑–Ω–æ—Å—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤',
            
            // –†–µ–≥—É–ª–∏—Ä—É—é—â–µ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ (regulatory_impact)
            'business_impact': '–û–ø–µ—Ä–∞—Ç–æ—Ä—ã –∫–∏–∫-—à–µ—Ä–∏–Ω–≥–∞: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏: —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ù–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –º–æ–≥—É—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ 10-15%.',
            'citizen_impact': '–ü–æ–≤—ã—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–µ—à–µ—Ö–æ–¥–æ–≤ –∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∑–æ–Ω–∞—Ö. –®—Ç—Ä–∞—Ñ—ã –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏—è –ü–î–î. –í–æ–∑–º–æ–∂–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∞—Ä–µ–Ω–¥—ã —ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç–æ–≤.',
            'administrative_burden': '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –æ—Ä–≥–∞–Ω—ã –ø–æ–ª–∏—Ü–∏–∏ –ø–æ –∫–æ–Ω—Ç—Ä–æ–ª—é –∑–∞ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö –Ω–æ—Ä–º. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤. –°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –∫–æ–Ω—Ç—Ä–æ–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∫–∏–∫-—à–µ—Ä–∏–Ω–≥–∞.',
            
            // –†–∏—Å–∫–∏ –∏ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è (risks_consequences)
            'corruption_risks': '–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ. –ß–µ—Ç–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–π —Å–Ω–∏–∂–∞—é—Ç —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Ñ–∏–∫—Å–∞—Ü–∏–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–π. –ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤.',
            'social_consequences': '–ü–æ–≤—ã—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è. –†–∞–∑–≤–∏—Ç–∏–µ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞. –í–æ–∑–º–æ–∂–Ω–æ–µ –Ω–µ–¥–æ–≤–æ–ª—å—Å—Ç–≤–æ —á–∞—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–æ–≤—ã–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏. –£–ª—É—á—à–µ–Ω–∏–µ –≥–æ—Ä–æ–¥—Å–∫–æ–π –º–æ–±–∏–ª—å–Ω–æ—Å—Ç–∏.',
            'implementation_timeline': '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–π –±–∞–∑—ã: 3 –º–µ—Å—è—Ü–∞. –û–±—É—á–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ–ª–∏—Ü–∏–∏: 2 –º–µ—Å—è—Ü–∞. –ü–µ—Ä–µ—Ö–æ–¥–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –¥–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤: 6 –º–µ—Å—è—Ü–µ–≤. –ü–æ–ª–Ω–æ–µ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ —Å–∏–ª—É: —Å 1 —è–Ω–≤–∞—Ä—è 2026 –≥–æ–¥–∞.'
        };
        
        // –ó–∞–ø–æ–ª–Ω—è–µ–º –≤—Å–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã
        Object.entries(testData).forEach(([name, value]) => {
            const field = form.querySelector(`[name="${name}"]`);
            if (field) {
                field.value = value;
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ input –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
                field.dispatchEvent(new Event('input', { bubbles: true }));
                field.dispatchEvent(new Event('change', { bubbles: true }));
            }
        });
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
        formData = {...testData};
        
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞–∑–¥–µ–ª–∞
        collectCurrentSectionData();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é
        updateProgress();
        validateRequiredFields();
        
        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –ø–µ—Ä–≤—ã–π —Ä–∞–∑–¥–µ–ª
        showSection(0);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        showNotification('–§–æ—Ä–º–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏!', 'success');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
        notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; max-width: 400px;';
        notification.innerHTML = `
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        
        document.body.appendChild(notification);
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            if (notification && notification.parentNode) {
                notification.remove();
            }
        }, 3000);
    }
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    validateBtn.addEventListener('click', function() {
        collectCurrentSectionData();
        
        fetch('/api/law-generator/validate', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
            displayValidationResults(data);
            generateBtn.disabled = !data.is_valid;
            validationResults = data;
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥–∞–Ω–Ω—ã—Ö');
        });
    });
    
    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    function displayValidationResults(results) {
        const container = document.getElementById('validation-results');
        const content = document.getElementById('validation-content');
        
        let html = '';
        
        if (results.is_valid) {
            html += '<div class="alert alert-success"><i class="fas fa-check-circle me-2"></i>–í—Å–µ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã!</div>';
        } else {
            html += '<div class="alert alert-danger"><i class="fas fa-exclamation-triangle me-2"></i>–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏</div>';
            
            if (results.errors && results.errors.length > 0) {
                html += '<h6>–û—à–∏–±–∫–∏:</h6><ul class="text-danger">';
                results.errors.forEach(error => {
                    html += `<li>${error}</li>`;
                });
                html += '</ul>';
            }
            
            if (results.missing_required && results.missing_required.length > 0) {
                html += '<h6>–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:</h6><ul class="text-warning">';
                results.missing_required.forEach(field => {
                    html += `<li>${field}</li>`;
                });
                html += '</ul>';
            }
        }
        
        if (results.warnings && results.warnings.length > 0) {
            html += '<h6>–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:</h6><ul class="text-info">';
            results.warnings.forEach(warning => {
                html += `<li>${warning}</li>`;
            });
            html += '</ul>';
        }
        
        if (results.suggestions && results.suggestions.length > 0) {
            html += '<h6>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</h6><ul class="text-muted">';
            results.suggestions.forEach(suggestion => {
                html += `<li>${suggestion}</li>`;
            });
            html += '</ul>';
        }
        
        html += `<p class="mb-0"><small class="text-muted">–ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å: ${results.completeness_score || 0}%</small></p>`;
        
        content.innerHTML = html;
        container.classList.remove('d-none');
        container.classList.add('d-block');
    }
    
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
    generateBtn.addEventListener('click', function() {
        collectCurrentSectionData();
        
        // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫
        const selectedLanguage = document.getElementById('generation-language').value;
        
        // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
        const requestData = {
            ...formData,
            generation_language: selectedLanguage
        };
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —è–∑—ã–∫–∞
        const loadingMessages = {
            'ru': {
                title: '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ',
                description: '–°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç —Å —Ä—É—Å—Å–∫–∏–º–∏ —Ä–∞–∑–¥–µ–ª–∞–º–∏ –∏ –∫–∞–∑–∞—Ö—Å–∫–∏–º–∏ –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏...'
            },
            'kz': {
                title: '–ó–∞“£ –∂–æ–±–∞—Å—ã–Ω “õ–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω–¥–µ –∂–∞—Å–∞—É',
                description: '“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω–¥–µ–≥—ñ –±”©–ª—ñ–º–¥–µ—Ä–º–µ–Ω “õ“±–∂–∞—Ç –∂–∞—Å–∞–ø –∂–∞—Ç—ã—Ä–º—ã–∑...'
            },
            'bilingual': {
                title: '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–≤—É—è–∑—ã—á–Ω–æ–≥–æ –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç–∞',
                description: '–°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç —Å –ø–æ–ª–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ –Ω–∞ –æ–±–æ–∏—Ö —è–∑—ã–∫–∞—Ö...'
            }
        };
        
        const messages = loadingMessages[selectedLanguage];
        document.getElementById('loading-message').textContent = messages.title;
        document.getElementById('loading-description').textContent = messages.description;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≥—Ä—É–∑–∫–∏
        const loadingModal = new bootstrap.Modal(document.getElementById('loadingModal'));
        loadingModal.show();
        
        fetch('/api/law-generator/generate', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(requestData)
        })
        .then(response => response.json())
        .then(data => {
            loadingModal.hide();
            displayGenerationResults(data);
        })
        .catch(error => {
            loadingModal.hide();
            console.error('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞');
        });
    });
    
    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    function displayGenerationResults(results) {
        const container = document.getElementById('generation-results');
        const content = document.getElementById('generation-content');
        
        if (results.success) {
            let html = `
                <div class="alert alert-success">
                    <i class="fas fa-check-circle me-2"></i>
                    –î–æ–∫—É–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω! ID: ${results.project_id}
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <h6>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ–∫—É–º–µ–Ω—Ç–µ:</h6>
                        <ul>
                            <li>–ù–∞–∑–≤–∞–Ω–∏–µ: ${results.metadata.title_ru}</li>
                            <li>–†–∞–∑–¥–µ–ª–æ–≤: ${results.metadata.total_sections}</li>
                            <li>–î–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ${new Date(results.generation_date).toLocaleString('ru')}</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6>–î–µ–π—Å—Ç–≤–∏—è:</h6>
                        <div class="d-grid gap-2">
                            <a href="/api/law-projects/${results.project_id}" class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-eye me-2"></i>–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å
                            </a>
                            <div class="dropdown">
                                <button class="btn btn-outline-success btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                    <i class="fas fa-download me-2"></i>–°–∫–∞—á–∞—Ç—å
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="/api/law-projects/${results.project_id}/export?format=pdf">
                                        <i class="fas fa-file-pdf me-2 text-danger"></i>PDF –¥–æ–∫—É–º–µ–Ω—Ç
                                    </a></li>
                                    <li><a class="dropdown-item" href="/api/law-projects/${results.project_id}/export?format=html">
                                        <i class="fas fa-code me-2 text-info"></i>HTML –¥–æ–∫—É–º–µ–Ω—Ç
                                    </a></li>
                                    <li><a class="dropdown-item" href="/api/law-projects/${results.project_id}/export?format=txt">
                                        <i class="fas fa-file-alt me-2 text-secondary"></i>–¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
                                    </a></li>
                                    <li><a class="dropdown-item" href="/api/law-projects/${results.project_id}/export?format=json">
                                        <i class="fas fa-file-code me-2 text-warning"></i>JSON —Ñ–∞–π–ª
                                    </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            if (results.sections) {
                html += '<h6 class="mt-3">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã:</h6>';
                html += '<div class="accordion" id="sectionsAccordion">';
                
                Object.entries(results.sections).forEach(([key, section], index) => {
                    html += `
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" 
                                        data-bs-toggle="collapse" data-bs-target="#section-${index}">
                                    ${getSectionTitle(key)}
                                </button>
                            </h2>
                            <div id="section-${index}" class="accordion-collapse collapse" 
                                 data-bs-parent="#sectionsAccordion">
                                <div class="accordion-body">
                                    <pre class="small">${section.content || JSON.stringify(section, null, 2)}</pre>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
            }
            
            content.innerHTML = html;
        } else {
            content.innerHTML = `
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ${results.error}
                </div>
            `;
        }
        
        container.classList.remove('d-none');
        container.classList.add('d-block');
        container.scrollIntoView({ behavior: 'smooth' });
    }
    
    // –°–ø—Ä–∞–≤–∫–∞ –ø–æ –ø–æ–ª—è–º
    document.addEventListener('click', function(e) {
        if (e.target.matches('[data-field]')) {
            const fieldName = e.target.getAttribute('data-field');
            showFieldHelp(fieldName);
        }
    });
    
    function showFieldHelp(fieldName) {
        fetch(`/api/law-generator/help/${fieldName}`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const modal = new bootstrap.Modal(document.getElementById('helpModal'));
                document.getElementById('help-content').innerHTML = `
                    <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${data.help.description}</p>
                    <p><strong>–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ:</strong> ${data.help.required ? '–î–∞' : '–ù–µ—Ç'}</p>
                `;
                modal.show();
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø—Ä–∞–≤–∫–∏:', error);
        });
    }
    
    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏–π —Ä–∞–∑–¥–µ–ª–æ–≤
    function getSectionTitle(key) {
        const titles = {
            'title_page': '1. –¢–∏—Ç—É–ª—å–Ω—ã–π –ª–∏—Å—Ç',
            'annotation': '2. –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è',
            'explanatory_note': '3. –ü–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞',
            'main_text': '4. –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç –∑–∞–∫–æ–Ω–∞',
            'comparison_table': '5. –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞',
            'financial_justification': '6. –§–∏–Ω–∞–Ω—Å–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ',
            'regulatory_impact': '7. –û—Ü–µ–Ω–∫–∞ —Ä–µ–≥—É–ª–∏—Ä—É—é—â–µ–≥–æ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è',
            'compliance_act': '8. –ê–∫—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è',
            'anticorruption_review': '9. –ê–Ω—Ç–∏–∫–æ—Ä—Ä—É–ø—Ü–∏–æ–Ω–Ω–∞—è —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞',
            'impact_forecast': '10. –ü—Ä–æ–≥–Ω–æ–∑ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π',
            'glossary': '11. –ì–ª–æ—Å—Å–∞—Ä–∏–π —Ç–µ—Ä–º–∏–Ω–æ–≤',
            'machine_readable': '12. –ú–∞—à–∏–Ω–æ—á–∏—Ç–∞–µ–º–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ',
            'audit_log': '13. –ê—É–¥–∏—Ç-–ª–æ–≥ –≤–µ—Ä—Å–∏–π'
        };
        return titles[key] || key;
    }
    
    // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    setInterval(() => {
        if (Object.keys(formData).length > 0) {
            localStorage.setItem('law_generator_data', JSON.stringify(formData));
        }
    }, 30000); // –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
    
    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    const savedData = localStorage.getItem('law_generator_data');
    if (savedData) {
        formData = JSON.parse(savedData);
        
        // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        Object.entries(formData).forEach(([name, value]) => {
            const field = form.querySelector(`[name="${name}"]`);
            if (field) {
                field.value = value;
            }
        });
        
        updateProgress();
        validateRequiredFields();
    }
    // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
    function loadProjectHistory() {
        fetch('/api/law-projects')
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                displayProjectHistory(data.projects, data.stats);
            } else {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏:', data.error);
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏:', error);
        });
    }
    
    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
    function displayProjectHistory(projects, stats) {
        const container = document.getElementById('history-content');
        
        if (projects.length === 0) {
            container.innerHTML = `
                <div class="text-center py-4">
                    <i class="fas fa-file-alt text-muted" style="font-size: 3rem;"></i>
                    <h6 class="mt-3 text-muted">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤</h6>
                    <p class="text-muted">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç, –∏ –æ–Ω –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</p>
                </div>
            `;
            return;
        }
        
        let html = `
            <div class="mb-3">
                <small class="text-muted">
                    –í—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–æ–≤: ${stats.total_projects} | 
                    –ó–∞ –º–µ—Å—è—Ü: ${stats.recent_projects} | 
                    –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö: ${stats.completed_projects || 0}
                </small>
            </div>
        `;
        
        projects.forEach(project => {
            const createdDate = new Date(project.created_at).toLocaleString('ru');
            
            html += `
                <div class="card mb-3">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-8">
                                <h6 class="card-title mb-1">${project.title_ru || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</h6>
                                <p class="card-text text-muted small mb-2">${project.title_kz || '–ê—Ç–∞—É—ã –∫”©—Ä—Å–µ—Ç—ñ–ª–º–µ–≥–µ–Ω'}</p>
                                <div class="d-flex align-items-center">
                                    <span class="badge bg-${project.status === 'completed' ? 'success' : 'warning'} me-2">
                                        ${project.status === 'completed' ? '–ó–∞–≤–µ—Ä—à–µ–Ω' : '–í —Ä–∞–±–æ—Ç–µ'}
                                    </span>
                                    <small class="text-muted">
                                        <i class="fas fa-user me-1"></i>${project.initiator || '–ù–µ —É–∫–∞–∑–∞–Ω'} | 
                                        <i class="fas fa-calendar me-1"></i>${createdDate}
                                    </small>
                                </div>
                            </div>
                            <div class="col-md-4 text-end">
                                <div class="btn-group-vertical w-100">
                                    <a href="/api/law-projects/${project.project_id}" class="btn btn-outline-primary btn-sm mb-1">
                                        <i class="fas fa-eye me-1"></i>–ü—Ä–æ—Å–º–æ—Ç—Ä
                                    </a>
                                    <div class="dropdown">
                                        <button class="btn btn-outline-success btn-sm dropdown-toggle w-100" type="button" data-bs-toggle="dropdown">
                                            <i class="fas fa-download me-1"></i>–°–∫–∞—á–∞—Ç—å
                                        </button>
                                        <ul class="dropdown-menu">
                                            <li><a class="dropdown-item" href="/api/law-projects/${project.project_id}/export?format=pdf">
                                                <i class="fas fa-file-pdf me-2 text-danger"></i>PDF
                                            </a></li>
                                            <li><a class="dropdown-item" href="/api/law-projects/${project.project_id}/export?format=html">
                                                <i class="fas fa-code me-2 text-info"></i>HTML
                                            </a></li>
                                            <li><a class="dropdown-item" href="/api/law-projects/${project.project_id}/export?format=txt">
                                                <i class="fas fa-file-alt me-2 text-secondary"></i>TXT
                                            </a></li>
                                            <li><a class="dropdown-item" href="/api/law-projects/${project.project_id}/export?format=json">
                                                <i class="fas fa-file-code me-2 text-warning"></i>JSON
                                            </a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        });
        
        container.innerHTML = html;
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    document.getElementById('historyModal').addEventListener('show.bs.modal', function() {
        loadProjectHistory();
    });
});
</script>

<!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ -->
<div class="modal fade" id="historyModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-history me-2"></i>
                    –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç–æ–≤
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="history-content">
                    <div class="text-center py-4">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </div>
                        <p class="mt-2 text-muted">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤...</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≥—Ä—É–∑–∫–∏ -->
<div class="modal fade" id="loadingModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body text-center py-4">
                <div class="spinner-border text-primary mb-3" role="status">
                    <span class="visually-hidden">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è...</span>
                </div>
                <h6>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç–∞</h6>
                <p class="text-muted mb-0">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ. –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç...</p>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–ø—Ä–∞–≤–∫–∏ -->
<div class="modal fade" id="helpModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-question-circle me-2"></i>
                    –°–ø—Ä–∞–≤–∫–∞ –ø–æ –ø–æ–ª—é
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="help-content">
                    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–ø—Ä–∞–≤–∫–∏ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –∑–¥–µ—Å—å -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
</div>

{% endblock %} 